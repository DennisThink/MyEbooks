安全考虑
IMAP4rev1协议事务，包括电子邮件数据，直接在网络上发送，除非有防窃听的保护。这是通过使用STARTTLS，AUTHENTICATE命令中通过了的秘密保护，或者一些其它的保护机制来完成的。

11.1. STARTTLS安全考虑
该文档中的STARTTLS命令和LOGINDISABLED功能的规范替代[IMAP-TLS]中的。[IMAP-TLS]保持PLAIN [SASL]认证的标准。

IMAP客户端和服务器实现体必须实现TLS_RSA_WITH_RC4_128_MD5 [TLS]密码体，并且应当实现TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA [TLS]密码体。这是重要的，因为这样才能保证任意两个兼容的实现体能够注册到一块。所有其它密码体都是OPTIONAL。注意，这个变更源于[IMAP-TLS]的2.1一节。

在[TLS]对话期间，客户端必须确认服务器主机名和出现在服务器证书邮件中的服务器标识，以免受中间人攻击。如果匹配失败，客户端应当请求用户的明确确认，或者终止连接，并指明该服务器标识是可疑的。匹配按照以下规则进行：

客户端必须把用来打开连接的服务器主机名和服务器证书中表示的服务器名相比较。客户端不能使用来源于一个不安全的远程资源的服务器主机名的任意形式（例如，不安全的DNS查找）。不执行CNAME规范。

匹配是不区分大小写的。

一个“*”通配符可以被用来表示证书中的左边任意多个字符。例如，*.example.com可以匹配a.example.com, foo.example.com, 等等，但是不能匹配example.com。

如果证书包含多个名（例如，多于一个的DNS名称域），那么这些域的任意一个的（成功）匹配就被认为是可接收的。

客户端和服务器必须确认STARTTLS命令和后续的[TLS]对话的结果，以了解是否完成了可接收的认证或者秘密。

11.2. 其它安全考虑
由无效信任书引起的，一个AUTHENTICATE命令的一个服务器错误邮件不应当详述为什么信任书无效。

使用LOGIN直接发送密码。这可以通过使用一个[SASL]机制的、不支持简单文本密码的AUTHENTICATE命令，通过经STARTTLS早期对话加密，或者其它保护机制避免。

一个服务器实现体必须实现一个配置，认证时，要求：

（１）STARTTLS命令已经通过。

或者

（２）其它保护会话防密码窃听的机制已经提供。

或者

（３）以下措施已采用：

（a）LOGINDISABLED功能被通报，且使用简单文本密码的[SASL]机制（如，PLAIN）没在功能列表中通报。

且

（b）AUTHENTICATE命令返回一个错误，即使密码是正确的。

（c）AUTHENTICATE命令返回使用简单文本密码的所有[SASL]机制的一个错误，即使密码是正确的。

针对一个失败的LOGIN命令的一个服务器错误邮件不应当指明该用户名，对于该密码，是无效的。

一个服务器应当有适当的机制限制或者延期失败的AUTHENTICATE/LOGIN尝试。

其它安全考虑在AUTHENTICATE及LOGIN命令的那一节中有讨论。
